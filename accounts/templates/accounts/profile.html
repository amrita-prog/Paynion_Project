{% extends "base.html" %}
{% block title %}My Profile{% endblock %}

{% block content %}
<div class="container mt-4 mb-5">

  <!-- ================= PROFILE HEADER ================= -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row align-items-center g-3">

        <div class="col-md-2 text-center">
          <img
            src="{% if request.user.profile_image %}{{ request.user.profile_image.url }}{% else %}/static/images/default-user.png{% endif %}"
            class="rounded-circle border"
            width="110"
            height="110"
            style="object-fit: cover;"
            alt="Profile Image">
        </div>

        <div class="col-md-7 text-center text-md-start">
          <h4 class="mb-1 fw-bold">{{ request.user.full_name }}</h4>
          <p class="text-muted mb-1">{{ request.user.email }}</p>
          <span class="badge bg-light text-secondary">
            Joined on {{ request.user.date_joined|date:"d M Y" }}
          </span>
        </div>

        <div class="col-md-3 text-center text-md-end">
          <a href="{% url 'accounts:edit_profile' %}" class="btn btn-outline-primary btn-sm px-4">
            Edit Profile
          </a>
        </div>

      </div>
    </div>
  </div>

  <!-- ================= DASHBOARD ROW ================= -->
  <div class="row g-4">

    <!-- ================= GROUPS ================= -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="fw-bold mb-3">
             My Groups
          </h5>

          {% if groups %}
            <ul class="list-group list-group-flush">
              {% for group in groups %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  <span class="fw-medium">{{ group.title }}</span>
                  <a href="{% url 'groups:group_detail' group.id %}"
                     class="btn btn-sm btn-outline-secondary">
                    View
                  </a>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-muted mb-0">
              You are not part of any group yet.
            </p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- ================= EXPENSE SUMMARY ================= -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="fw-bold mb-3">
            Expense Summary
          </h5>

          <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Total Paid by Me</span>
            <span class="fw-semibold text-success">₹ {{ total_paid_by_me }}</span>
          </div>

          <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">I Need to Pay</span>
            <span class="fw-semibold text-danger">₹ {{ total_need_to_pay }}</span>
          </div>

          <div class="d-flex justify-content-between mb-3">
            <span class="text-muted">I Will Get Back</span>
            <span class="fw-semibold text-primary">₹ {{ total_get_back }}</span>
          </div>

          <a href="{% url 'accounts:my_expenses' %}"
             class="btn btn-outline-primary btn-sm w-100">
            View My Expenses
          </a>
        </div>
      </div>
    </div>

  </div>

  <!-- ================= ACCOUNT ACTIONS ================= -->
  <div class="card shadow-sm mt-4">
    <div class="card-body d-flex flex-wrap justify-content-between gap-3">

      <a href="{% url 'accounts:logout' %}" class="btn btn-outline-danger px-4">
        Logout
      </a>

    </div>
  </div>

</div>
{% endblock %}
